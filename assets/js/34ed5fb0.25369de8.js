"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[718],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=a.createContext({}),p=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=p(n),h=o,g=c["".concat(i,".").concat(h)]||c[h]||u[h]||r;return n?a.createElement(g,l(l({ref:t},d),{},{components:n})):a.createElement(g,l({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,l=new Array(r);l[0]=c;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:o,l[1]=s;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(7294),o=n(6010);const r="tabItem_Ymn6";function l(e){let{children:t,hidden:n,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(r,l),hidden:n},t)}},5488:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(7462),o=n(7294),r=n(6010),l=n(2389),s=n(7392),i=n(7094),p=n(2466);const d="tabList__CuJ",u="tabItem_LNqP";function c(e){var t;const{lazy:n,block:l,defaultValue:c,values:h,groupId:g,className:m}=e,k=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),b=h??k.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),f=(0,s.l)(b,((e,t)=>e.value===t.value));if(f.length>0)throw new Error(`Docusaurus error: Duplicate values "${f.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const v=null===c?c:c??(null==(t=k.find((e=>e.props.default)))?void 0:t.props.value)??k[0].props.value;if(null!==v&&!b.some((e=>e.value===v)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${v}" but none of its children has the corresponding value. Available values are: ${b.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:w,setTabGroupChoices:y}=(0,i.U)(),[O,N]=(0,o.useState)(v),I=[],{blockElementScrollPositionUntilNextRender:E}=(0,p.o5)();if(null!=g){const e=w[g];null!=e&&e!==O&&b.some((t=>t.value===e))&&N(e)}const T=e=>{const t=e.currentTarget,n=I.indexOf(t),a=b[n].value;a!==O&&(E(t),N(a),null!=g&&y(g,String(a)))},Z=e=>{var t;let n=null;switch(e.key){case"ArrowRight":{const t=I.indexOf(e.currentTarget)+1;n=I[t]??I[0];break}case"ArrowLeft":{const t=I.indexOf(e.currentTarget)-1;n=I[t]??I[I.length-1];break}}null==(t=n)||t.focus()};return o.createElement("div",{className:(0,r.Z)("tabs-container",d)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":l},m)},b.map((e=>{let{value:t,label:n,attributes:l}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:O===t?0:-1,"aria-selected":O===t,key:t,ref:e=>I.push(e),onKeyDown:Z,onFocus:T,onClick:T},l,{className:(0,r.Z)("tabs__item",u,null==l?void 0:l.className,{"tabs__item--active":O===t})}),n??t)}))),n?(0,o.cloneElement)(k.filter((e=>e.props.value===O))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},k.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==O})))))}function h(e){const t=(0,l.Z)();return o.createElement(c,(0,a.Z)({key:String(t)},e))}},2467:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>p,toc:()=>u});var a=n(7462),o=(n(7294),n(3905)),r=n(5488),l=n(5162);const s={title:"Enable Opni AIOps",slug:"/installation/opni/aiops"},i=void 0,p={unversionedId:"installation/opni/aiops",id:"installation/opni/aiops",title:"Enable Opni AIOps",description:"Logging backend must be enabled before enabling AIOps",source:"@site/docs/installation/opni/aiops.md",sourceDirName:"installation/opni",slug:"/installation/opni/aiops",permalink:"/installation/opni/aiops",draft:!1,editUrl:"https://github.com/rancher/opni-docs/edit/main/docs/installation/opni/aiops.md",tags:[],version:"current",frontMatter:{title:"Enable Opni AIOps",slug:"/installation/opni/aiops"},sidebar:"tutorialSidebar",previous:{title:"Opni Backends",permalink:"/installation/opni/backends"},next:{title:"Enable SLOs",permalink:"/installation/opni/slo"}},d={},u=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Prerequisites",id:"prerequisites-1",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Remove workloads",id:"remove-workloads",level:3},{value:"Reset workloads",id:"reset-workloads",level:3},{value:"Enabling AI Services",id:"enabling-ai-services",level:2},{value:"Consuming AI Insights from Opni",id:"consuming-ai-insights-from-opni",level:2},{value:"Overall Insights",id:"overall-insights",level:3},{value:"Workload Log Insights",id:"workload-log-insights",level:3},{value:"Kubernetes Control Plane and Etcd Log Insights",id:"kubernetes-control-plane-and-etcd-log-insights",level:3},{value:"Rancher Log Insights",id:"rancher-log-insights",level:3},{value:"Longhorn Log Insights",id:"longhorn-log-insights",level:3}],c={toc:u};function h(e){let{components:t,...s}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Logging backend must be enabled before enabling AIOps")),(0,o.kt)("p",null,"Opni AIOps currently features ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"log anomaly detection"))," - it provides log insights by distinguishing normal and anomalous logs. Log anomaly detection comes in two flavors:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Pre-trained models"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Models trained by SUSE Rancher that specialize on K8s control plane, Rancher, and Longhorn logs"),(0,o.kt)("li",{parentName:"ul"},"Do not require a GPU"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Auto generated models for user selected workloads"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"User selects 1 or more workload deployments important to them"),(0,o.kt)("li",{parentName:"ul"},"Opni will self train a model and provide insights for logs belonging to user selected workloads"),(0,o.kt)("li",{parentName:"ul"},"NVIDIA GPU is required to run")))),(0,o.kt)("p",null,"Learn more about the two flavors below."),(0,o.kt)("hr",null),(0,o.kt)(r.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"pre-trained",label:"Pretrained models",mdxType:"TabItem"},(0,o.kt)("p",null,"Opni log anomaly detection comes with three specialized pretrained Deep Learning models which are maintained by SUSE Rancher. These models have been optimized to ",(0,o.kt)("strong",{parentName:"p"},"not require a GPU")," for usage, provide ",(0,o.kt)("strong",{parentName:"p"},"state-of-the-art accuracy")," and each one has a ",(0,o.kt)("strong",{parentName:"p"},"size just under 80 MB.")," Use these models to ",(0,o.kt)("strong",{parentName:"p"},"accelerate mean time to resolution"),"."),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("p",null,"The Opni cluster must have ",(0,o.kt)("strong",{parentName:"p"},"Opni logging")," enabled."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Kubernetes control plane and etcd logs")),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Compatible with control plane and etcd logs from RKE1, RKE2 and K3s distributions."),(0,o.kt)("li",{parentName:"ul"},"Identifies granular anomalies within specific Kubernetes components."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Rancher logs")," "),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Compatible with any distribution of Kubernetes that is running any distribution of ",(0,o.kt)("a",{parentName:"li",href:"https://docs.ranchermanager.rancher.io/versions"},"Rancher"),"."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Longhorn logs")),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Compatible with any distribution of Kubernetes that is running any distribution of ",(0,o.kt)("a",{parentName:"li",href:"https://longhorn.io"},"Longhorn"),"."))))),(0,o.kt)(l.Z,{value:"workload",label:"Auto generated models for user selected workloads",mdxType:"TabItem"},"Opni AIOps offers log anomaly detection on user's workload logs with the following features:",(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"self-train models that learn from logs of the workloads user have selected"),(0,o.kt)("li",{parentName:"ul"},"Doesn't require high volume of data to get started"),(0,o.kt)("li",{parentName:"ul"},"No AI/ML knowledge needed")),(0,o.kt)("p",null,"Note that it requires an GPU available in the Opni cluster."),(0,o.kt)("h2",{id:"prerequisites-1"},"Prerequisites"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Opni logging enabled"),(0,o.kt)("li",{parentName:"ul"},"Enabling AIOps and the GPU Services"),(0,o.kt)("li",{parentName:"ul"},"At least 1 NVIDIA GPU attached")),(0,o.kt)("h2",{id:"getting-started"},"Getting Started"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"SetupWorkloads",src:n(3881).Z,width:"2557",height:"1254"})),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Within the Opni Admin Dashboard, once AIOps has been enabled, go to the Workload Insights Tab."),(0,o.kt)("li",{parentName:"ol"},"Select a cluster"),(0,o.kt)("li",{parentName:"ol"},"Select the workloads you want"),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Update Watchlist")," to submit the configuration")),(0,o.kt)("p",null,"The UI will give a status of the progress of the model.\n",(0,o.kt)("img",{alt:"Model Training Status",src:n(2739).Z,width:"5116",height:"2516"})),(0,o.kt)("p",null,"Once the model is ready, you can then navigate to Opni's Opensearch dashboard and ",(0,o.kt)("a",{parentName:"p",href:"#consuming-ai-insights-from-opni"},"consume AI Insights"),"."),(0,o.kt)("h3",{id:"remove-workloads"},"Remove workloads"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"RemoveWorkloads",src:n(2868).Z,width:"5116",height:"2502"})),(0,o.kt)("p",null,"To remove the workloads you don't want anymore, simply uncheck the boxes and ",(0,o.kt)("strong",{parentName:"p"},"Update Watchlist"),"."),(0,o.kt)("h3",{id:"reset-workloads"},"Reset workloads"),(0,o.kt)("p",null,"To reset your watchlist, simply hit the button ",(0,o.kt)("strong",{parentName:"p"},"Clear Watchlist"),"."))),(0,o.kt)("h2",{id:"enabling-ai-services"},"Enabling AI Services"),(0,o.kt)("p",null,"Setting up log anomaly detection for Opni can be done through the Opni admin dashboard. Go to the AIOps section and then check the pretrained models that the user would like to receive insights from. If a GPU is enabled on this cluster and the user would like to receive insights on selected workloads, check the ",(0,o.kt)("strong",{parentName:"p"},"Enable GPU services")," button."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Enable AIOps",src:n(6195).Z,width:"2547",height:"634"})),(0,o.kt)("h2",{id:"consuming-ai-insights-from-opni"},"Consuming AI Insights from Opni"),(0,o.kt)("p",null,"Once Opni logging has been enabled in the central cluster, log anomaly insights can now be obtained by going to Opensearch Dashboards and viewing the Opni plugin."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Opensearch Dashboards Opni Plugin",src:n(7121).Z,width:"324",height:"870"})),(0,o.kt)("h3",{id:"overall-insights"},"Overall Insights"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Opensearch Dashboards Overall Breakdown",src:n(8276).Z,width:"1918",height:"569"})),(0,o.kt)("p",null,"The Opni UI within Opensearch breaks down the status of all clusters into an ",(0,o.kt)("strong",{parentName:"p"},"easy-to-consume")," manner.\nFrom the top two panels, the left chart shows the overall number of normal and anomalous logs in the system and the right chart shows the breakdown of anomalous log messages from Kubernetes control plane components."),(0,o.kt)("h3",{id:"workload-log-insights"},"Workload Log Insights"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Opensearch Dashboards Workload Component",src:n(4116).Z,width:"4726",height:"734"})),(0,o.kt)("p",null,"For workload logs, the Opni UI will display the breakdown of normal and anomalous log messages at a pod level among the selected deployments."),(0,o.kt)("h3",{id:"kubernetes-control-plane-and-etcd-log-insights"},"Kubernetes Control Plane and Etcd Log Insights"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Opensearch Dashboards Control Plane Component",src:n(4100).Z,width:"1897",height:"806"})),(0,o.kt)("p",null,"For control plane logs, the Opni UI allows the user to ",(0,o.kt)("strong",{parentName:"p"},"zone in on specific Kubernetes components")," and upon clicking on the number of anomalous or normal log messages, the user will be redirected to the actual log messages that were ",(0,o.kt)("strong",{parentName:"p"},"inferred on by the pretrained Deep Learning model for control plane logs"),"."),(0,o.kt)("h3",{id:"rancher-log-insights"},"Rancher Log Insights"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Opensearch Dashboards Rancher Logs",src:n(6793).Z,width:"4736",height:"1510"})),(0,o.kt)("p",null,"Similar to the control plane logs, Rancher logs are also displayed in an easy-to-consume manner where the user can be redirected to the Dashboards page to view the actual log messages that were ",(0,o.kt)("strong",{parentName:"p"},"inferred by the pretrained deep learning model for Rancher logs"),"."),(0,o.kt)("h3",{id:"longhorn-log-insights"},"Longhorn Log Insights"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Opensearch Dashboards Longhorn Logs",src:n(3276).Z,width:"4778",height:"2206"}),"\nLonghorn logs are displayed in an easy-to-consume manner where the user can be redirected to the Dashboards page to view the actual log messages that were ",(0,o.kt)("strong",{parentName:"p"},"inferred by the pretrained deep learning model for Longhorn logs")))}h.isMDXComponent=!0},6195:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/admin_dashboard_enable_ai-ea2235618e55371ed87d92a4e72eb831.png"},3881:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/initial_workload_configuration-c4347169dd1a3ab7a0cb6c06f5228e36.png"},3276:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/longhorn_opni_log_anomaly-977aaaded2960ae33bc681d744721660.png"},8276:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/opensearch_dashboards_overall-e060aedafd0f6a73606cd3db78936e74.png"},7121:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/opensearch_opni_plugin-63aefb869d00541ffbbdd28f6417c9f1.png"},4100:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/opni_controlplane_breakdown-47d152813c7ef7d22aaeb73a780ef973.png"},2739:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/opni_train_workload_model-8cc60b206b8621d5b6caa9ac9a7b96ee.png"},6793:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/rancher_log_insights-a405b392ec61243ed0ab633dbbb90459.png"},2868:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/remove_workload_insights-68573fcedd33005f97efc076df490da3.png"},4116:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/workload_insights_panel-4f2512592caeae907d204515577e8607.png"}}]);